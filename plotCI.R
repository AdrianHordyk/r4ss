plotCI <-
  function (x, y = NULL, uiw, liw = uiw, ylo = NULL, yhi = NULL,
            ..., sfrac = 0.01, ymax = NULL, add = FALSE, col = "black") {
    # Written by Venables; modified for access to ylim, contents, and color
    if (is.list(x)) {
      y <- x$y
      x <- x$x
    }
    if (is.null(y)) {
      if (is.null(x)) {
        stop("both x and y NULL")
      }
      y <- as.numeric(x)
      x <- seq(along = x)
    }
    ui <- y + uiw
    li <- y - liw
    ylim <- range(c(y, ui, li, ylo, yhi))
    if(!is.null(ymax)) ylim[2] <- ymax
    if (!add) plot(x, y, type='n', ylim = ylim, col= col,...)
    segments(x, li, x, ui, col= col)
    smidge <- diff(par("usr")[1:2]) * sfrac
    x2 <- c(x, x)
    ul <- c(li, ui)
    segments(x2 - smidge, ul, x2 + smidge, ul, col= col)
    points(x, y, col= col, ...)
    invisible(list(x = x, y = y))
  }
